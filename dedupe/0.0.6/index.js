(function(){"use strict";(function(e,o){globalThis.pluginStyle||(globalThis.pluginStyle={}),globalThis.pluginStyle[o.styleId]=e})('counter.svelte-mf9nd9{display:inline;background:var(--color-blue-dark);color:var(--color-white-dark);padding:0 .25rem;border-radius:2rem;line-height:18px;min-width:20px}group-card.svelte-1w2newb.svelte-1w2newb{display:inline-grid;border:var(--color-black) 1px solid;cursor:pointer;height:80px;padding:0rem;grid-template-columns:1fr 25px}group-card.selected.svelte-1w2newb.svelte-1w2newb{background:var(--color-blue-dark);color:var(--color-yellow)}group-card.svelte-1w2newb.svelte-1w2newb:hover:not(.selected){background:var(--color-blue-light)}group-card.svelte-1w2newb .left.svelte-1w2newb{--padding:1rem;padding:var(--padding) 0 var(--padding) var(--padding);overflow:hidden}group-card.svelte-1w2newb .right.svelte-1w2newb{padding:.3rem}group-card.svelte-1w2newb ul.svelte-1w2newb{padding:0;margin:0}group-card.svelte-1w2newb li.svelte-1w2newb{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}group-card-list.svelte-1333sb2{display:flex;flex-direction:column;gap:1rem}button.tscd-button.svelte-d1v8ly{--padding:.5rem;display:inline-flex;place-items:center;padding:var(--padding) calc(var(--padding) * 2);font-family:inherit;gap:.5rem;justify-content:center;letter-spacing:2%;line-height:100%;background-color:#000;color:#fff;border-radius:4px;border:none;cursor:pointer;transition:all .1s ease-in-out}button.tscd-button.svelte-d1v8ly:hover{background-color:var(--color-gray-1);color:#000}button.tscd-button.block.svelte-d1v8ly{width:100%}button.tscd-button.primary.dangerous.svelte-d1v8ly,button.tscd-button.secondary.dangerous.svelte-d1v8ly,button.tscd-button.tertiary.dangerous.svelte-d1v8ly{color:var(--color-pink)}button.tscd-button.primary.dangerous.svelte-d1v8ly:hover,button.tscd-button.secondary.dangerous.svelte-d1v8ly:hover,button.tscd-button.tertiary.dangerous.svelte-d1v8ly:hover{background-color:var(--color-pink);color:var(--color-white)}button.tscd-button.primary.svelte-d1v8ly:disabled,button.tscd-button.primary.svelte-d1v8ly:disabled:hover,button.tscd-button.secondary.svelte-d1v8ly:disabled,button.tscd-button.secondary.svelte-d1v8ly:disabled:hover,button.tscd-button.tertiary.svelte-d1v8ly:disabled,button.tscd-button.tertiary.svelte-d1v8ly:disabled:hover{background-color:var(--color-grey-3);color:var(--color-grey-1)}button.tscd-button.primary.svelte-d1v8ly{background-color:var(--color-blue-dark);color:var(--color-white);border:var(--color-blue-dark) thin solid}button.tscd-button.primary.svelte-d1v8ly:hover{background-color:var(--color-blue);color:var(--color-yellow)}button.tscd-button.primary.svelte-d1v8ly:active{background-color:var(--color-blue-light);color:var(--color-black)}button.tscd-button.secondary.svelte-d1v8ly{background-color:var(--color-white);color:var(--color-blue);border:black thin solid}button.tscd-button.secondary.svelte-d1v8ly:hover{background-color:var(--color-blue-light)}button.tscd-button.secondary.svelte-d1v8ly:active{background-color:var(--color-blue-dark);color:var(--color-yellow)}button.tscd-button.tertiary.svelte-d1v8ly{background:none;border:none;color:var(--color-blue)}button.tscd-button.tertiary.svelte-d1v8ly:hover{background:var(--color-blue-light)}button.tscd-button.tertiary.svelte-d1v8ly:active{background:var(--color-blue);color:var(--color-white)}button.tscd-button.tertiary.svelte-d1v8ly:disabled,button.tscd-button.tertiary.svelte-d1v8ly:disabled:hover{background:none}label.svelte-8pg148{display:flex;align-items:center;gap:.5rem}merger.svelte-10wi0be.svelte-10wi0be{display:grid;height:100%;grid-template-rows:2fr auto;grid-template-columns:repeat(2,auto) 1fr;text-align:left;gap:.5rem}merger.svelte-10wi0be ul.svelte-10wi0be{margin:0;padding:0;list-style-type:none;display:flex;flex-direction:column;gap:.5rem}merger.svelte-10wi0be .action.svelte-10wi0be{grid-column:3/4;justify-self:left;padding:2rem}merger.svelte-10wi0be .structure.svelte-10wi0be{border-right:var(--color-black) thin solid;display:grid;grid-template-rows:auto 1fr;height:100%;overflow:hidden}merger.svelte-10wi0be .structure ul.svelte-10wi0be{height:100%;overflow:auto}merger.svelte-10wi0be .list-container.svelte-10wi0be{border-right:var(--color-black) thin solid;display:grid;height:100%;grid-template-rows:auto auto 1fr}merger.svelte-10wi0be .list-container ul.svelte-10wi0be{height:100%;overflow:auto}merger.svelte-10wi0be .list.svelte-10wi0be{display:flex;flex-direction:column;gap:.5rem}merger.svelte-10wi0be>div.svelte-10wi0be{padding:.5rem}merger.svelte-10wi0be .select-all-container.svelte-10wi0be{margin-bottom:1rem;display:flex;justify-content:end}merger.svelte-10wi0be .action.svelte-10wi0be{display:flex;flex-direction:row;gap:.5rem;height:40px}merger.svelte-10wi0be .usage.svelte-10wi0be{height:100%;overflow:hidden;display:grid;grid-template-rows:auto 1fr}merger.svelte-10wi0be .usage ul.svelte-10wi0be{height:100%;overflow:auto}:root,:host{--color-white:#FFFFFF;--color-white-dark:#f2f2f2;--color-yellow:#D9D800;--color-blue:#004552;--color-blue-dark:#14343e;--color-blue-1:#3253A8;--color-blue-light:#e5ecee;--color-torques:#007D80;--color-green:#288409;--color-black:#000000;--color-beige-1:burlywood;--color-beige-2:blanchedalmond;--color-pink:#C73C61;--color-grey-1:#626262;--color-grey-2:#808080;--color-grey-3:#bdbdbd;--color-primary:var(--color-yellow);--color-secondary:var(--color-blue);--color-text:var(--color-white);--color-text-disabled-1:rgba(0, 0, 0, .4);--border-radius:4px;--font-family:"Avenir Next", sans-serif;--letter-spacing:.2px;--font-size:12px;--color-ied-focus:var(--color-beige-1);--color-ied-focus-hover:var(--color-beige-2);--color-button-group-default:#5F6E75;--color-button-group-selected:#004552;--color-message-goose:var(--color-green);--color-message-mms:var(--color-blue-1);--color-message-sampledvalues:var(--color-pink);--sidebar-width:400px}:root,:host{font-family:var(--font-family);letter-spacing:var(--letter-spacing);font-size:var(--font-size)}dedupe.svelte-49sy0h{--header-hight:146px;height:calc(100vh - var(--header-hight));display:block;padding:1rem;overflow:hidden}main.svelte-49sy0h{height:100%;overflow:hidden}layout.svelte-49sy0h{display:grid;grid-template-columns:minmax(100px,150px) 1fr;height:100%}sidebar.svelte-49sy0h{border-right:black thin solid;padding-right:1rem;height:100%;overflow:auto}',{styleId:"@oscd-plugins/dedupe"})})();
var tt = Object.defineProperty;
var nt = (t, e, n) => e in t ? tt(t, e, { enumerable: !0, configurable: !0, writable: !0, value: n }) : t[e] = n;
var ke = (t, e, n) => (nt(t, typeof e != "symbol" ? e + "" : e, n), n);
function U() {
}
function We(t) {
  return t();
}
function Ae() {
  return /* @__PURE__ */ Object.create(null);
}
function le(t) {
  t.forEach(We);
}
function Ye(t) {
  return typeof t == "function";
}
function V(t, e) {
  return t != t ? e == e : t !== e || t && typeof t == "object" || typeof t == "function";
}
function lt(t) {
  return Object.keys(t).length === 0;
}
function Ne(t) {
  return t ?? "";
}
function _(t, e) {
  t.appendChild(e);
}
function w(t, e, n) {
  t.insertBefore(e, n || null);
}
function S(t) {
  t.parentNode && t.parentNode.removeChild(t);
}
function fe(t, e) {
  for (let n = 0; n < t.length; n += 1)
    t[n] && t[n].d(e);
}
function p(t) {
  return document.createElement(t);
}
function B(t) {
  return document.createTextNode(t);
}
function O() {
  return B(" ");
}
function rt() {
  return B("");
}
function ne(t, e, n, l) {
  return t.addEventListener(e, n, l), () => t.removeEventListener(e, n, l);
}
function b(t, e, n) {
  n == null ? t.removeAttribute(e) : t.getAttribute(e) !== n && t.setAttribute(e, n);
}
function ue(t, e, n) {
  e in t ? t[e] = typeof t[e] == "boolean" && n === "" ? !0 : n : b(t, e, n);
}
function st(t) {
  return Array.from(t.childNodes);
}
function X(t, e) {
  e = "" + e, t.wholeText !== e && (t.data = e);
}
function Ce(t, e) {
  for (let n = 0; n < t.options.length; n += 1) {
    const l = t.options[n];
    if (l.__value === e) {
      l.selected = !0;
      return;
    }
  }
  t.selectedIndex = -1;
}
function de(t, e, n) {
  t.classList[n ? "add" : "remove"](e);
}
function ct(t, e, { bubbles: n = !1, cancelable: l = !1 } = {}) {
  const r = document.createEvent("CustomEvent");
  return r.initCustomEvent(t, n, l, e), r;
}
let _e;
function me(t) {
  _e = t;
}
function ot() {
  if (!_e)
    throw new Error("Function called outside component initialization");
  return _e;
}
function Ze() {
  const t = ot();
  return (e, n, { cancelable: l = !1 } = {}) => {
    const r = t.$$.callbacks[e];
    if (r) {
      const c = ct(e, n, { cancelable: l });
      return r.slice().forEach((s) => {
        s.call(t, c);
      }), !c.defaultPrevented;
    }
    return !0;
  };
}
function ge(t, e) {
  const n = t.$$.callbacks[e.type];
  n && n.slice().forEach((l) => l.call(this, e));
}
const ae = [], we = [], ye = [], Ie = [], it = Promise.resolve();
let Te = !1;
function ut() {
  Te || (Te = !0, it.then($e));
}
function De(t) {
  ye.push(t);
}
const Se = /* @__PURE__ */ new Set();
let ie = 0;
function $e() {
  if (ie !== 0)
    return;
  const t = _e;
  do {
    try {
      for (; ie < ae.length; ) {
        const e = ae[ie];
        ie++, me(e), at(e.$$);
      }
    } catch (e) {
      throw ae.length = 0, ie = 0, e;
    }
    for (me(null), ae.length = 0, ie = 0; we.length; )
      we.pop()();
    for (let e = 0; e < ye.length; e += 1) {
      const n = ye[e];
      Se.has(n) || (Se.add(n), n());
    }
    ye.length = 0;
  } while (ae.length);
  for (; Ie.length; )
    Ie.pop()();
  Te = !1, Se.clear(), me(t);
}
function at(t) {
  if (t.fragment !== null) {
    t.update(), le(t.before_update);
    const e = t.dirty;
    t.dirty = [-1], t.fragment && t.fragment.p(t.ctx, e), t.after_update.forEach(De);
  }
}
const ve = /* @__PURE__ */ new Set();
let te;
function pe() {
  te = {
    r: 0,
    c: [],
    p: te
    // parent group
  };
}
function be() {
  te.r || le(te.c), te = te.p;
}
function v(t, e) {
  t && t.i && (ve.delete(t), t.i(e));
}
function I(t, e, n, l) {
  if (t && t.o) {
    if (ve.has(t))
      return;
    ve.add(t), te.c.push(() => {
      ve.delete(t), l && (n && t.d(1), l());
    }), t.o(e);
  } else
    l && l();
}
function K(t) {
  t && t.c();
}
function z(t, e, n, l) {
  const { fragment: r, after_update: c } = t.$$;
  r && r.m(e, n), l || De(() => {
    const s = t.$$.on_mount.map(We).filter(Ye);
    t.$$.on_destroy ? t.$$.on_destroy.push(...s) : le(s), t.$$.on_mount = [];
  }), c.forEach(De);
}
function J(t, e) {
  const n = t.$$;
  n.fragment !== null && (le(n.on_destroy), n.fragment && n.fragment.d(e), n.on_destroy = n.fragment = null, n.ctx = []);
}
function ft(t, e) {
  t.$$.dirty[0] === -1 && (ae.push(t), ut(), t.$$.dirty.fill(0)), t.$$.dirty[e / 31 | 0] |= 1 << e % 31;
}
function W(t, e, n, l, r, c, s, o = [-1]) {
  const i = _e;
  me(t);
  const u = t.$$ = {
    fragment: null,
    ctx: [],
    // state
    props: c,
    update: U,
    not_equal: r,
    bound: Ae(),
    // lifecycle
    on_mount: [],
    on_destroy: [],
    on_disconnect: [],
    before_update: [],
    after_update: [],
    context: new Map(e.context || (i ? i.$$.context : [])),
    // everything else
    callbacks: Ae(),
    dirty: o,
    skip_bound: !1,
    root: e.target || i.$$.root
  };
  s && s(u.root);
  let a = !1;
  if (u.ctx = n ? n(t, e.props || {}, (d, m, ...y) => {
    const T = y.length ? y[0] : m;
    return u.ctx && r(u.ctx[d], u.ctx[d] = T) && (!u.skip_bound && u.bound[d] && u.bound[d](T), a && ft(t, d)), m;
  }) : [], u.update(), a = !0, le(u.before_update), u.fragment = l ? l(u.ctx) : !1, e.target) {
    if (e.hydrate) {
      const d = st(e.target);
      u.fragment && u.fragment.l(d), d.forEach(S);
    } else
      u.fragment && u.fragment.c();
    e.intro && v(t.$$.fragment), z(t, e.target, e.anchor, e.customElement), $e();
  }
  me(i);
}
class Y {
  $destroy() {
    J(this, 1), this.$destroy = U;
  }
  $on(e, n) {
    if (!Ye(n))
      return U;
    const l = this.$$.callbacks[e] || (this.$$.callbacks[e] = []);
    return l.push(n), () => {
      const r = l.indexOf(n);
      r !== -1 && l.splice(r, 1);
    };
  }
  $set(e) {
    this.$$set && !lt(e) && (this.$$.skip_bound = !0, this.$$set(e), this.$$.skip_bound = !1);
  }
}
const R = class {
  constructor(t) {
    this.root = t;
  }
  searchGSEs(t) {
    return this.searchElement(R.SelectorGSE, ["ldInst", "cbName"], t);
  }
  searchIEDs(t) {
    return this.searchElement(R.SelectorIED, ["name"], t);
  }
  searchGSEControls(t) {
    return this.searchElement(
      R.SelectorGSEControl,
      ["name", "datSet"],
      t
    );
  }
  searchInputs(t) {
    return this.searchElement(R.SelectorInput, [], t);
  }
  searchExtRef(t) {
    return this.searchElement(
      R.SelectorExtRef,
      [
        "iedName",
        "serviceType",
        // "ldInst",
        // "lnClass",
        // "lnInst",
        // "prefix",
        // "doName",
        // "daName",
        // "srcLDInst",
        // "srcPrefix",
        "srcCBName"
      ],
      t
    );
  }
  searchDataSetByName(t, e) {
    const n = `${R.SelectorDataSet}[name="${t}"]`, l = this.searchElement(
      n,
      ["name"],
      e
    );
    if (l.length !== 1) {
      console.log({ level: "error", msg: "we found not exactly one element", length: l.length });
      return;
    }
    return l[0];
  }
  searchElementsLDParent(t) {
    const e = t.closest(R.SelectorLD);
    if (!e) {
      console.log({ level: "error", msg: "could not find LD parent", element: t });
      return;
    }
    return Ee(e, ["inst"]);
  }
  searchGSE(t, e, n) {
    const l = `${R.SelectorGSEElement}[ldInst='${t}'][cbName='${e}']`, r = this.searchElement(l, ["cbName", "ldInst"], n);
    if (r.length !== 1) {
      console.error({
        level: "error",
        msg: "we did not found exaclty one GSE element",
        length: r.length,
        ldInst: t,
        cbName: e,
        selector: l,
        root: this.root,
        options: n
      });
      return;
    }
    return r[0];
  }
  searchElementsParentSubnetwork(t) {
    const e = t.closest(R.SelectorSubNetwork);
    if (!e) {
      console.error({ level: "error", msg: "could not find SubNetwork parent", element: t });
      return;
    }
    return Ee(e, ["name"]);
  }
  searchDOTypes(t) {
    return this.searchElement(R.DOType, ["id"], t);
  }
  searchDOsByType(t, e) {
    const n = `${R.DO}[type='${t}']`;
    return this.searchElement(n, ["name", "type"], e);
  }
  searchLNodeTypes(t) {
    return this.searchElement(R.LNodeType, ["id", "lnClass"], t);
  }
  // 
  // Privates
  // 
  searchElement(t, e, n) {
    const l = this.determineRoot(n);
    return Array.from(l.querySelectorAll(t)).map((s) => Ee(s, e));
  }
  determineRoot(t) {
    return t != null && t.root ? t.root : this.root;
  }
};
let P = R;
P.SelectorGSE = "GSE";
P.SelectorIED = "IED";
P.SelectorGSEControl = "GSEControl";
P.SelectorInput = "Inputs";
P.SelectorExtRef = "ExtRef";
P.SelectorDataSet = "DataSet";
P.SelectorLD = "LDevice";
P.SelectorGSEElement = "GSE";
P.SelectorSubNetwork = "SubNetwork";
P.DOType = "DOType";
P.DO = "DO";
P.LNodeType = "LNodeType";
function Ee(t, e) {
  const n = { element: t };
  for (const l of e) {
    const r = l;
    n[r] = t.getAttribute(r) ?? "";
  }
  return n;
}
function dt(t) {
  let e, n;
  const l = {};
  for (const r of Array.from(t.children).filter((c) => c.tagName === "EnumVal").sort((c, s) => {
    let o, i;
    return parseInt((o = c.getAttribute("ord")) !== null && o !== void 0 ? o : "", 10) - parseInt((i = s.getAttribute("ord")) !== null && i !== void 0 ? i : "", 10);
  }))
    l[(e = r.getAttribute("ord")) !== null && e !== void 0 ? e : ""] = (n = r.textContent) !== null && n !== void 0 ? n : "";
  return { vals: l };
}
function ht(t) {
  let e;
  const n = {};
  for (const l of Array.from(t.children).filter((r) => r.tagName === "BDA").sort((r, c) => r.outerHTML.localeCompare(c.outerHTML))) {
    const [r, c, s, o, i] = [
      "bType",
      "type",
      "dchg",
      "dupd",
      "qchg"
    ].map((u) => l.getAttribute(u));
    n[(e = l.getAttribute("name")) !== null && e !== void 0 ? e : ""] = { bType: r, type: c, dchg: s, dupd: o, qchg: i };
  }
  return { bdas: n };
}
function mt(t) {
  const e = {};
  for (const l of Array.from(t.children).filter((r) => r.tagName === "SDO").sort((r, c) => r.outerHTML.localeCompare(c.outerHTML))) {
    const [r, c, s] = ["name", "type", "transient"].map((o) => l.getAttribute(o));
    e[r ?? ""] = { type: c, transient: s };
  }
  const n = {};
  for (const l of Array.from(t.children).filter((r) => r.tagName === "DA").sort((r, c) => r.outerHTML.localeCompare(c.outerHTML))) {
    const [r, c, s, o, i, u, a] = [
      "name",
      "fc",
      "bType",
      "type",
      "dchg",
      "dupd",
      "qchg"
    ].map((d) => l.getAttribute(d));
    n[r ?? ""] = {
      fc: c,
      bType: s,
      type: o,
      dchg: i,
      dupd: u,
      qchg: a
    };
  }
  return {
    sdos: e,
    das: n,
    cdc: t.getAttribute("cdc")
  };
}
function _t(t) {
  const e = {};
  for (const n of Array.from(t.children).filter((l) => l.tagName === "DO").sort((l, r) => l.outerHTML.localeCompare(r.outerHTML))) {
    const [l, r, c] = ["name", "type", "transient"].map((s) => n.getAttribute(s));
    e[l ?? ""] = { type: r, transient: c };
  }
  return {
    dos: e,
    lnClass: t.getAttribute("lnClass")
  };
}
const Le = {
  EnumType: dt,
  DAType: ht,
  DOType: mt,
  LNodeType: _t
};
function gt(t) {
  let e, n;
  return (n = (e = Le[t.tagName]) === null || e === void 0 ? void 0 : e.call(Le, t)) !== null && n !== void 0 ? n : { xml: t.outerHTML };
}
function pt(t) {
  const e = gt(t);
  return bt(JSON.stringify(e));
}
async function bt(t) {
  const e = new TextEncoder().encode(t), n = await crypto.subtle.digest("SHA-256", e);
  return Array.from(new Uint8Array(n)).map((c) => c.toString(16).padStart(2, "0")).join("");
}
class yt {
  constructor(e) {
    this.scdQueries = e;
  }
  async findDuplicateObjectTypes() {
    const e = this.scdQueries.searchDOTypes(), n = await Promise.all(
      e.map(this.createHashedDot.bind(this))
    ), l = this.groupByHash(n);
    return Object.values(l).filter((c) => c.length > 1);
  }
  findUsageOfDOT(e) {
    return this.scdQueries.searchDOsByType(e);
  }
  async createHashedDot(e) {
    const n = await pt(e.element), l = this.findUsageOfDOT(e.id);
    return {
      element: e,
      hash: n,
      usages: l
    };
  }
  groupByHash(e) {
    const n = {};
    for (const l of e)
      n[l.hash] || (n[l.hash] = []), n[l.hash].push(l);
    return n;
  }
}
function vt(t) {
  let e = (
    /*max*/
    t[1] - 1 + ""
  ), n, l;
  return {
    c() {
      n = B(e), l = B("+");
    },
    m(r, c) {
      w(r, n, c), w(r, l, c);
    },
    p(r, c) {
      c & /*max*/
      2 && e !== (e = /*max*/
      r[1] - 1 + "") && X(n, e);
    },
    d(r) {
      r && S(n), r && S(l);
    }
  };
}
function kt(t) {
  let e;
  return {
    c() {
      e = B(
        /*count*/
        t[0]
      );
    },
    m(n, l) {
      w(n, e, l);
    },
    p(n, l) {
      l & /*count*/
      1 && X(
        e,
        /*count*/
        n[0]
      );
    },
    d(n) {
      n && S(e);
    }
  };
}
function St(t) {
  let e;
  function n(c, s) {
    return (
      /*count*/
      c[0] <= /*max*/
      c[1] ? kt : vt
    );
  }
  let l = n(t), r = l(t);
  return {
    c() {
      e = p("counter"), r.c(), b(e, "class", "svelte-mf9nd9");
    },
    m(c, s) {
      w(c, e, s), r.m(e, null);
    },
    p(c, [s]) {
      l === (l = n(c)) && r ? r.p(c, s) : (r.d(1), r = l(c), r && (r.c(), r.m(e, null)));
    },
    i: U,
    o: U,
    d(c) {
      c && S(e), r.d();
    }
  };
}
function Et(t, e, n) {
  let { count: l } = e, { max: r = 100 } = e;
  return t.$$set = (c) => {
    "count" in c && n(0, l = c.count), "max" in c && n(1, r = c.max);
  }, [l, r];
}
class wt extends Y {
  constructor(e) {
    super(), W(this, e, Et, St, V, { count: 0, max: 1 });
  }
}
function Oe(t, e, n) {
  const l = t.slice();
  return l[7] = e[n], l;
}
function Ge(t) {
  let e, n = (
    /*item*/
    t[7] + ""
  ), l;
  return {
    c() {
      e = p("li"), l = B(n), b(e, "class", "svelte-1w2newb");
    },
    m(r, c) {
      w(r, e, c), _(e, l);
    },
    p(r, c) {
      c & /*displayedItems*/
      16 && n !== (n = /*item*/
      r[7] + "") && X(l, n);
    },
    d(r) {
      r && S(e);
    }
  };
}
function Tt(t) {
  let e, n, l, r, c, s, o, i, u, a = (
    /*displayedItems*/
    t[4]
  ), d = [];
  for (let m = 0; m < a.length; m += 1)
    d[m] = Ge(Oe(t, a, m));
  return s = new wt({
    props: { count: (
      /*items*/
      t[0].length
    ) }
  }), {
    c() {
      e = p("group-card"), n = p("div"), l = p("ul");
      for (let m = 0; m < d.length; m += 1)
        d[m].c();
      r = O(), c = p("div"), K(s.$$.fragment), b(l, "class", "svelte-1w2newb"), b(n, "class", "left svelte-1w2newb"), b(c, "class", "right svelte-1w2newb"), ue(
        e,
        "data-testid",
        /*dataTestid*/
        t[1]
      ), ue(
        e,
        "title",
        /*titleText*/
        t[3]
      ), ue(e, "class", "svelte-1w2newb"), de(
        e,
        "selected",
        /*selected*/
        t[2]
      );
    },
    m(m, y) {
      w(m, e, y), _(e, n), _(n, l);
      for (let T = 0; T < d.length; T += 1)
        d[T].m(l, null);
      _(e, r), _(e, c), z(s, c, null), o = !0, i || (u = [
        ne(
          e,
          "click",
          /*click_handler*/
          t[5]
        ),
        ne(
          e,
          "keypress",
          /*keypress_handler*/
          t[6]
        )
      ], i = !0);
    },
    p(m, [y]) {
      if (y & /*displayedItems*/
      16) {
        a = /*displayedItems*/
        m[4];
        let k;
        for (k = 0; k < a.length; k += 1) {
          const F = Oe(m, a, k);
          d[k] ? d[k].p(F, y) : (d[k] = Ge(F), d[k].c(), d[k].m(l, null));
        }
        for (; k < d.length; k += 1)
          d[k].d(1);
        d.length = a.length;
      }
      const T = {};
      y & /*items*/
      1 && (T.count = /*items*/
      m[0].length), s.$set(T), (!o || y & /*dataTestid*/
      2) && ue(
        e,
        "data-testid",
        /*dataTestid*/
        m[1]
      ), (!o || y & /*titleText*/
      8) && ue(
        e,
        "title",
        /*titleText*/
        m[3]
      ), (!o || y & /*selected*/
      4) && de(
        e,
        "selected",
        /*selected*/
        m[2]
      );
    },
    i(m) {
      o || (v(s.$$.fragment, m), o = !0);
    },
    o(m) {
      I(s.$$.fragment, m), o = !1;
    },
    d(m) {
      m && S(e), fe(d, m), J(s), i = !1, le(u);
    }
  };
}
const Dt = 3;
function At(t, e, n) {
  let l, r, { items: c = [] } = e, { dataTestid: s = "" } = e, { selected: o = !1 } = e;
  function i(a) {
    ge.call(this, t, a);
  }
  function u(a) {
    ge.call(this, t, a);
  }
  return t.$$set = (a) => {
    "items" in a && n(0, c = a.items), "dataTestid" in a && n(1, s = a.dataTestid), "selected" in a && n(2, o = a.selected);
  }, t.$$.update = () => {
    t.$$.dirty & /*items*/
    1 && n(4, l = c.slice(0, Dt)), t.$$.dirty & /*items*/
    1 && n(3, r = c.join(`
`));
  }, [
    c,
    s,
    o,
    r,
    l,
    i,
    u
  ];
}
class Nt extends Y {
  constructor(e) {
    super(), W(this, e, At, Tt, V, { items: 0, dataTestid: 1, selected: 2 });
  }
}
function Me(t, e, n) {
  const l = t.slice();
  return l[5] = e[n], l[7] = n, l;
}
function He(t) {
  let e, n;
  function l() {
    return (
      /*click_handler*/
      t[3](
        /*ii*/
        t[7]
      )
    );
  }
  return e = new Nt({
    props: {
      items: (
        /*itemSet*/
        t[5]
      ),
      dataTestid: `card_${/*ii*/
      t[7]}`,
      selected: (
        /*selectedIndex*/
        t[1] === /*ii*/
        t[7]
      )
    }
  }), e.$on("click", l), {
    c() {
      K(e.$$.fragment);
    },
    m(r, c) {
      z(e, r, c), n = !0;
    },
    p(r, c) {
      t = r;
      const s = {};
      c & /*itemSets*/
      1 && (s.items = /*itemSet*/
      t[5]), c & /*selectedIndex*/
      2 && (s.selected = /*selectedIndex*/
      t[1] === /*ii*/
      t[7]), e.$set(s);
    },
    i(r) {
      n || (v(e.$$.fragment, r), n = !0);
    },
    o(r) {
      I(e.$$.fragment, r), n = !1;
    },
    d(r) {
      J(e, r);
    }
  };
}
function Ct(t) {
  let e, n, l = (
    /*itemSets*/
    t[0]
  ), r = [];
  for (let s = 0; s < l.length; s += 1)
    r[s] = He(Me(t, l, s));
  const c = (s) => I(r[s], 1, 1, () => {
    r[s] = null;
  });
  return {
    c() {
      e = p("group-card-list");
      for (let s = 0; s < r.length; s += 1)
        r[s].c();
      ue(e, "class", "svelte-1333sb2");
    },
    m(s, o) {
      w(s, e, o);
      for (let i = 0; i < r.length; i += 1)
        r[i].m(e, null);
      n = !0;
    },
    p(s, [o]) {
      if (o & /*itemSets, selectedIndex, handleClick*/
      7) {
        l = /*itemSets*/
        s[0];
        let i;
        for (i = 0; i < l.length; i += 1) {
          const u = Me(s, l, i);
          r[i] ? (r[i].p(u, o), v(r[i], 1)) : (r[i] = He(u), r[i].c(), v(r[i], 1), r[i].m(e, null));
        }
        for (pe(), i = l.length; i < r.length; i += 1)
          c(i);
        be();
      }
    },
    i(s) {
      if (!n) {
        for (let o = 0; o < l.length; o += 1)
          v(r[o]);
        n = !0;
      }
    },
    o(s) {
      r = r.filter(Boolean);
      for (let o = 0; o < r.length; o += 1)
        I(r[o]);
      n = !1;
    },
    d(s) {
      s && S(e), fe(r, s);
    }
  };
}
function It(t, e, n) {
  let { itemSets: l = [] } = e, { selectedIndex: r = -1 } = e;
  const c = Ze();
  function s(i) {
    c("select", { index: i });
  }
  const o = (i) => s(i);
  return t.$$set = (i) => {
    "itemSets" in i && n(0, l = i.itemSets), "selectedIndex" in i && n(1, r = i.selectedIndex);
  }, [l, r, s, o];
}
class Lt extends Y {
  constructor(e) {
    super(), W(this, e, It, Ct, V, { itemSets: 0, selectedIndex: 1 });
  }
}
function Ot(t) {
  let e, n, l, r, c;
  return {
    c() {
      e = p("button"), n = B(
        /*label*/
        t[2]
      ), b(e, "class", l = Ne(`tscd-button ${/*type*/
      t[5]}`) + " svelte-d1v8ly"), e.disabled = /*disabled*/
      t[4], b(
        e,
        "data-testid",
        /*testid*/
        t[3]
      ), de(
        e,
        "block",
        /*block*/
        t[0]
      ), de(
        e,
        "dangerous",
        /*dangerous*/
        t[1]
      );
    },
    m(s, o) {
      w(s, e, o), _(e, n), r || (c = ne(
        e,
        "click",
        /*click_handler*/
        t[6]
      ), r = !0);
    },
    p(s, [o]) {
      o & /*label*/
      4 && X(
        n,
        /*label*/
        s[2]
      ), o & /*type*/
      32 && l !== (l = Ne(`tscd-button ${/*type*/
      s[5]}`) + " svelte-d1v8ly") && b(e, "class", l), o & /*disabled*/
      16 && (e.disabled = /*disabled*/
      s[4]), o & /*testid*/
      8 && b(
        e,
        "data-testid",
        /*testid*/
        s[3]
      ), o & /*type, block*/
      33 && de(
        e,
        "block",
        /*block*/
        s[0]
      ), o & /*type, dangerous*/
      34 && de(
        e,
        "dangerous",
        /*dangerous*/
        s[1]
      );
    },
    i: U,
    o: U,
    d(s) {
      s && S(e), r = !1, c();
    }
  };
}
function Gt(t, e, n) {
  let { block: l = !1 } = e, { dangerous: r = !1 } = e, { label: c } = e, { testid: s = "" } = e, { disabled: o = !1 } = e, { type: i = "primary" } = e;
  function u(a) {
    ge.call(this, t, a);
  }
  return t.$$set = (a) => {
    "block" in a && n(0, l = a.block), "dangerous" in a && n(1, r = a.dangerous), "label" in a && n(2, c = a.label), "testid" in a && n(3, s = a.testid), "disabled" in a && n(4, o = a.disabled), "type" in a && n(5, i = a.type);
  }, [l, r, c, s, o, i, u];
}
class Be extends Y {
  constructor(e) {
    super(), W(this, e, Gt, Ot, V, {
      block: 0,
      dangerous: 1,
      label: 2,
      testid: 3,
      disabled: 4,
      type: 5
    });
  }
}
function Mt(t) {
  let e, n, l, r, c, s, o, i;
  return {
    c() {
      e = p("checkbox"), n = p("label"), l = p("input"), r = O(), c = p("span"), s = B(
        /*label*/
        t[1]
      ), b(l, "type", "checkbox"), b(n, "class", "svelte-8pg148"), b(
        e,
        "data-testid",
        /*testid*/
        t[2]
      );
    },
    m(u, a) {
      w(u, e, a), _(e, n), _(n, l), l.checked = /*checked*/
      t[0], _(n, r), _(n, c), _(c, s), o || (i = [
        ne(
          l,
          "change",
          /*change_handler*/
          t[3]
        ),
        ne(
          l,
          "input",
          /*input_handler*/
          t[4]
        ),
        ne(
          l,
          "change",
          /*input_change_handler*/
          t[5]
        )
      ], o = !0);
    },
    p(u, [a]) {
      a & /*checked*/
      1 && (l.checked = /*checked*/
      u[0]), a & /*label*/
      2 && X(
        s,
        /*label*/
        u[1]
      ), a & /*testid*/
      4 && b(
        e,
        "data-testid",
        /*testid*/
        u[2]
      );
    },
    i: U,
    o: U,
    d(u) {
      u && S(e), o = !1, le(i);
    }
  };
}
function Ht(t, e, n) {
  let { checked: l = !1 } = e, { label: r } = e, { testid: c = "" } = e;
  function s(u) {
    ge.call(this, t, u);
  }
  function o(u) {
    ge.call(this, t, u);
  }
  function i() {
    l = this.checked, n(0, l);
  }
  return t.$$set = (u) => {
    "checked" in u && n(0, l = u.checked), "label" in u && n(1, r = u.label), "testid" in u && n(2, c = u.testid);
  }, [l, r, c, s, o, i];
}
class Bt extends Y {
  constructor(e) {
    super(), W(this, e, Ht, Mt, V, { checked: 0, label: 1, testid: 2 });
  }
}
function je(t, e, n) {
  const l = t.slice();
  return l[15] = e[n], l[17] = n, l;
}
function Re(t, e, n) {
  const l = t.slice();
  return l[18] = e[n], l;
}
function Pe(t, e, n) {
  const l = t.slice();
  return l[15] = e[n], l[17] = n, l;
}
function Qe(t, e, n) {
  const l = t.slice();
  return l[15] = e[n], l;
}
function qe(t) {
  let e, n = (
    /*item*/
    t[15] + ""
  ), l;
  return {
    c() {
      e = p("li"), l = B(n);
    },
    m(r, c) {
      w(r, e, c), _(e, l);
    },
    p(r, c) {
      c & /*structure*/
      2 && n !== (n = /*item*/
      r[15] + "") && X(l, n);
    },
    d(r) {
      r && S(e);
    }
  };
}
function Fe(t) {
  let e, n, l, r;
  function c(...s) {
    return (
      /*change_handler*/
      t[12](
        /*ii*/
        t[17],
        ...s
      )
    );
  }
  return n = new Bt({
    props: {
      checked: (
        /*checkedIndexes*/
        t[2].has(
          /*ii*/
          t[17]
        )
      ),
      label: (
        /*item*/
        t[15].label
      ),
      testid: `merger_checkbox-${/*ii*/
      t[17]}`
    }
  }), n.$on("change", c), {
    c() {
      e = p("li"), K(n.$$.fragment), l = O();
    },
    m(s, o) {
      w(s, e, o), z(n, e, null), _(e, l), r = !0;
    },
    p(s, o) {
      t = s;
      const i = {};
      o & /*checkedIndexes*/
      4 && (i.checked = /*checkedIndexes*/
      t[2].has(
        /*ii*/
        t[17]
      )), o & /*items*/
      1 && (i.label = /*item*/
      t[15].label), n.$set(i);
    },
    i(s) {
      r || (v(n.$$.fragment, s), r = !0);
    },
    o(s) {
      I(n.$$.fragment, s), r = !1;
    },
    d(s) {
      s && S(e), J(n);
    }
  };
}
function Ue(t) {
  let e, n = (
    /*lnType*/
    t[18].ln + ""
  ), l, r, c = (
    /*lnType*/
    t[18].dot + ""
  ), s, o;
  return {
    c() {
      e = p("li"), l = B(n), r = B(" ("), s = B(c), o = B(")");
    },
    m(i, u) {
      w(i, e, u), _(e, l), _(e, r), _(e, s), _(e, o);
    },
    p(i, u) {
      u & /*affectedLNTypes*/
      16 && n !== (n = /*lnType*/
      i[18].ln + "") && X(l, n), u & /*affectedLNTypes*/
      16 && c !== (c = /*lnType*/
      i[18].dot + "") && X(s, c);
    },
    d(i) {
      i && S(e);
    }
  };
}
function ze(t) {
  let e, n = (
    /*item*/
    t[15].label + ""
  ), l;
  return {
    c() {
      e = p("option"), l = B(n), e.__value = /*ii*/
      t[17], e.value = e.__value;
    },
    m(r, c) {
      w(r, e, c), _(e, l);
    },
    p(r, c) {
      c & /*items*/
      1 && n !== (n = /*item*/
      r[15].label + "") && X(l, n);
    },
    d(r) {
      r && S(e);
    }
  };
}
function jt(t) {
  let e, n, l, r, c, s, o, i, u, a, d, m, y, T, k, F, re, g, D, N, C, j, Z, Q, x, he, se, $ = (
    /*structure*/
    t[1]
  ), G = [];
  for (let f = 0; f < $.length; f += 1)
    G[f] = qe(Qe(t, $, f));
  d = new Be({
    props: {
      label: "Select All",
      testid: "merger_select-all",
      type: "secondary"
    }
  }), d.$on(
    "click",
    /*handleSelectAll*/
    t[9]
  );
  let ee = (
    /*items*/
    t[0]
  ), E = [];
  for (let f = 0; f < ee.length; f += 1)
    E[f] = Fe(Pe(t, ee, f));
  const et = (f) => I(E[f], 1, 1, () => {
    E[f] = null;
  });
  let ce = (
    /*affectedLNTypes*/
    t[4]
  ), M = [];
  for (let f = 0; f < ce.length; f += 1)
    M[f] = Ue(Re(t, ce, f));
  let oe = (
    /*items*/
    t[0]
  ), H = [];
  for (let f = 0; f < oe.length; f += 1)
    H[f] = ze(je(t, oe, f));
  return Q = new Be({
    props: {
      label: "Merge",
      block: !0,
      testid: "merger_button-merge",
      disabled: !/*isMergePossible*/
      t[5]
    }
  }), Q.$on(
    "click",
    /*handleMergeClick*/
    t[7]
  ), {
    c() {
      e = p("merger"), n = p("div"), l = p("h3"), l.textContent = "Structure", r = O(), c = p("ul");
      for (let f = 0; f < G.length; f += 1)
        G[f].c();
      s = O(), o = p("div"), i = p("h3"), i.textContent = "Duplicate DOTypes", u = O(), a = p("div"), K(d.$$.fragment), m = O(), y = p("ul");
      for (let f = 0; f < E.length; f += 1)
        E[f].c();
      T = O(), k = p("div"), F = p("h3"), F.textContent = "Affected LN Types", re = O(), g = p("ul");
      for (let f = 0; f < M.length; f += 1)
        M[f].c();
      D = O(), N = p("div"), C = p("select"), j = p("option"), j.textContent = "Select a merge target";
      for (let f = 0; f < H.length; f += 1)
        H[f].c();
      Z = O(), K(Q.$$.fragment), b(c, "class", "structure-list svelte-10wi0be"), b(n, "class", "structure svelte-10wi0be"), b(a, "class", "select-all-container svelte-10wi0be"), b(y, "class", "list svelte-10wi0be"), b(o, "class", "list-container svelte-10wi0be"), b(g, "class", "svelte-10wi0be"), b(k, "class", "usage svelte-10wi0be"), j.__value = -1, j.value = j.__value, j.disabled = !0, j.selected = !0, b(C, "data-testid", "merger_merge-target"), b(N, "class", "action svelte-10wi0be"), b(e, "class", "svelte-10wi0be");
    },
    m(f, A) {
      w(f, e, A), _(e, n), _(n, l), _(n, r), _(n, c);
      for (let L = 0; L < G.length; L += 1)
        G[L].m(c, null);
      _(e, s), _(e, o), _(o, i), _(o, u), _(o, a), z(d, a, null), _(o, m), _(o, y);
      for (let L = 0; L < E.length; L += 1)
        E[L].m(y, null);
      _(e, T), _(e, k), _(k, F), _(k, re), _(k, g);
      for (let L = 0; L < M.length; L += 1)
        M[L].m(g, null);
      _(e, D), _(e, N), _(N, C), _(C, j);
      for (let L = 0; L < H.length; L += 1)
        H[L].m(C, null);
      Ce(
        C,
        /*selectedMergeTargetIndex*/
        t[3]
      ), _(N, Z), z(Q, N, null), x = !0, he || (se = ne(
        C,
        "change",
        /*handleTargetInputChange*/
        t[8]
      ), he = !0);
    },
    p(f, [A]) {
      if (A & /*structure*/
      2) {
        $ = /*structure*/
        f[1];
        let h;
        for (h = 0; h < $.length; h += 1) {
          const q = Qe(f, $, h);
          G[h] ? G[h].p(q, A) : (G[h] = qe(q), G[h].c(), G[h].m(c, null));
        }
        for (; h < G.length; h += 1)
          G[h].d(1);
        G.length = $.length;
      }
      if (A & /*checkedIndexes, items, handleChange*/
      69) {
        ee = /*items*/
        f[0];
        let h;
        for (h = 0; h < ee.length; h += 1) {
          const q = Pe(f, ee, h);
          E[h] ? (E[h].p(q, A), v(E[h], 1)) : (E[h] = Fe(q), E[h].c(), v(E[h], 1), E[h].m(y, null));
        }
        for (pe(), h = ee.length; h < E.length; h += 1)
          et(h);
        be();
      }
      if (A & /*affectedLNTypes*/
      16) {
        ce = /*affectedLNTypes*/
        f[4];
        let h;
        for (h = 0; h < ce.length; h += 1) {
          const q = Re(f, ce, h);
          M[h] ? M[h].p(q, A) : (M[h] = Ue(q), M[h].c(), M[h].m(g, null));
        }
        for (; h < M.length; h += 1)
          M[h].d(1);
        M.length = ce.length;
      }
      if (A & /*items*/
      1) {
        oe = /*items*/
        f[0];
        let h;
        for (h = 0; h < oe.length; h += 1) {
          const q = je(f, oe, h);
          H[h] ? H[h].p(q, A) : (H[h] = ze(q), H[h].c(), H[h].m(C, null));
        }
        for (; h < H.length; h += 1)
          H[h].d(1);
        H.length = oe.length;
      }
      (!x || A & /*selectedMergeTargetIndex*/
      8) && Ce(
        C,
        /*selectedMergeTargetIndex*/
        f[3]
      );
      const L = {};
      A & /*isMergePossible*/
      32 && (L.disabled = !/*isMergePossible*/
      f[5]), Q.$set(L);
    },
    i(f) {
      if (!x) {
        v(d.$$.fragment, f);
        for (let A = 0; A < ee.length; A += 1)
          v(E[A]);
        v(Q.$$.fragment, f), x = !0;
      }
    },
    o(f) {
      I(d.$$.fragment, f), E = E.filter(Boolean);
      for (let A = 0; A < E.length; A += 1)
        I(E[A]);
      I(Q.$$.fragment, f), x = !1;
    },
    d(f) {
      f && S(e), fe(G, f), J(d), fe(E, f), fe(M, f), fe(H, f), J(Q), he = !1, se();
    }
  };
}
function Rt(t, e, n) {
  let l, r, c, { items: s = [] } = e, { structure: o = [] } = e;
  const i = Ze();
  let u = /* @__PURE__ */ new Set(), a = [];
  function d(g, D) {
    D.target.checked ? u.add(g) : u.delete(g), n(2, u);
  }
  function m(g) {
    const D = [];
    for (const N of g) {
      const C = s[N], j = C.usages;
      for (const Z of j)
        D.push({ ln: Z, dot: C.label });
    }
    return D;
  }
  function y(g) {
    const D = [...Array.from(u.values())];
    l && i("merge", {
      selectedIndexes: D,
      selectedMergeTargetIndex: T
    });
  }
  let T = -1;
  function k(g) {
    const N = g.target.value, C = parseInt(N);
    n(3, T = C);
  }
  function F(g) {
    g.target.checked, s.forEach((D, N) => u.add(N)), n(2, u);
  }
  const re = (g, D) => d(g, D);
  return t.$$set = (g) => {
    "items" in g && n(0, s = g.items), "structure" in g && n(1, o = g.structure);
  }, t.$$.update = () => {
    t.$$.dirty & /*checkedIndexes*/
    4 && n(4, a = m([...u.values()])), t.$$.dirty & /*checkedIndexes*/
    4 && n(10, c = u.size > 0), t.$$.dirty & /*selectedMergeTargetIndex*/
    8 && n(11, r = T > -1), t.$$.dirty & /*isSomeDuplicateSelected, isTargetSelected*/
    3072 && n(5, l = c && r);
  }, [
    s,
    o,
    u,
    T,
    a,
    l,
    d,
    y,
    k,
    F,
    c,
    r,
    re
  ];
}
class Pt extends Y {
  constructor(e) {
    super(), W(this, e, Rt, jt, V, { items: 0, structure: 1 });
  }
}
class Qt extends Y {
  constructor(e) {
    super(), W(this, e, null, null, V, {});
  }
}
function Je(t) {
  let e = (
    /*selectedGroupIndex*/
    t[0]
  ), n, l, r = Ve(t);
  return {
    c() {
      r.c(), n = rt();
    },
    m(c, s) {
      r.m(c, s), w(c, n, s), l = !0;
    },
    p(c, s) {
      s & /*selectedGroupIndex*/
      1 && V(e, e = /*selectedGroupIndex*/
      c[0]) ? (pe(), I(r, 1, 1, U), be(), r = Ve(c), r.c(), v(r, 1), r.m(n.parentNode, n)) : r.p(c, s);
    },
    i(c) {
      l || (v(r), l = !0);
    },
    o(c) {
      I(r), l = !1;
    },
    d(c) {
      c && S(n), r.d(c);
    }
  };
}
function Ve(t) {
  let e, n;
  return e = new Pt({
    props: {
      items: (
        /*itemSets*/
        t[2][
          /*selectedGroupIndex*/
          t[0]
        ]
      ),
      structure: (
        /*structure*/
        t[3]
      )
    }
  }), e.$on(
    "merge",
    /*handleMerge*/
    t[5]
  ), {
    c() {
      K(e.$$.fragment);
    },
    m(l, r) {
      z(e, l, r), n = !0;
    },
    p(l, r) {
      const c = {};
      r & /*itemSets, selectedGroupIndex*/
      5 && (c.items = /*itemSets*/
      l[2][
        /*selectedGroupIndex*/
        l[0]
      ]), r & /*structure*/
      8 && (c.structure = /*structure*/
      l[3]), e.$set(c);
    },
    i(l) {
      n || (v(e.$$.fragment, l), n = !0);
    },
    o(l) {
      I(e.$$.fragment, l), n = !1;
    },
    d(l) {
      J(e, l);
    }
  };
}
function qt(t) {
  let e, n, l, r, c, s, o, i, u;
  e = new Qt({}), s = new Lt({
    props: {
      itemSets: (
        /*itemSets*/
        t[2].map(Xe)
      ),
      selectedIndex: (
        /*selectedGroupIndex*/
        t[0]
      )
    }
  }), s.$on(
    "select",
    /*handleGroupSelect*/
    t[4]
  );
  let a = (
    /*selectedGroupIndex*/
    t[0] > -1 && Je(t)
  );
  return {
    c() {
      K(e.$$.fragment), n = O(), l = p("dedupe"), r = p("layout"), c = p("sidebar"), K(s.$$.fragment), o = O(), i = p("main"), a && a.c(), b(c, "class", "svelte-49sy0h"), b(i, "class", "svelte-49sy0h"), b(r, "class", "svelte-49sy0h"), b(l, "class", "svelte-49sy0h");
    },
    m(d, m) {
      z(e, d, m), w(d, n, m), w(d, l, m), _(l, r), _(r, c), z(s, c, null), _(r, o), _(r, i), a && a.m(i, null), t[8](l), u = !0;
    },
    p(d, [m]) {
      const y = {};
      m & /*itemSets*/
      4 && (y.itemSets = /*itemSets*/
      d[2].map(Xe)), m & /*selectedGroupIndex*/
      1 && (y.selectedIndex = /*selectedGroupIndex*/
      d[0]), s.$set(y), /*selectedGroupIndex*/
      d[0] > -1 ? a ? (a.p(d, m), m & /*selectedGroupIndex*/
      1 && v(a, 1)) : (a = Je(d), a.c(), v(a, 1), a.m(i, null)) : a && (pe(), I(a, 1, 1, () => {
        a = null;
      }), be());
    },
    i(d) {
      u || (v(e.$$.fragment, d), v(s.$$.fragment, d), v(a), u = !0);
    },
    o(d) {
      I(e.$$.fragment, d), I(s.$$.fragment, d), I(a), u = !1;
    },
    d(d) {
      J(e, d), d && S(n), d && S(l), J(s), a && a.d(), t[8](null);
    }
  };
}
function Ft(t) {
  const e = "_", n = t.element.parentElement;
  return n ? n.getAttribute("id") ?? e : e;
}
function Ut(t, e) {
  const n = t.element.cloneNode(!0);
  return n.setAttribute("type", e.id), zt(t.element, n);
}
function zt(t, e) {
  return {
    old: { element: t },
    new: { element: e }
  };
}
const Xe = (t) => t.map((e) => e.label);
function Jt(t, e, n) {
  let { doc: l } = e, r, c, s;
  function o(g) {
    g && (r = new P(g), c = new yt(r), u());
  }
  let i;
  async function u() {
    n(7, i = await c.findDuplicateObjectTypes());
  }
  let a = [];
  function d(g) {
    g && n(2, a = g.map((D) => D.map((N) => ({
      label: N.element.id,
      usages: N.usages.map(Ft)
    }))));
  }
  let m = -1;
  function y(g) {
    n(0, m = g.detail.index);
  }
  let T = [];
  function k(g, D) {
    if (D < 0)
      return;
    const C = g[D][0], Z = Array.from(C.element.element.children).map((Q) => Q.getAttribute("name") ?? "");
    n(3, T = Z.filter(Boolean));
  }
  function F(g) {
    const { selectedIndexes: D, selectedMergeTargetIndex: N } = g.detail, C = i[m], j = D.map((se) => C[se]), Z = C[N], x = { action: { actions: j.map((se) => se.usages.map(($) => Ut($, Z.element))).flat() } }, he = new CustomEvent("editor-action", { detail: x, composed: !0, bubbles: !0 });
    s.dispatchEvent(he);
  }
  function re(g) {
    we[g ? "unshift" : "push"](() => {
      s = g, n(1, s);
    });
  }
  return t.$$set = (g) => {
    "doc" in g && n(6, l = g.doc);
  }, t.$$.update = () => {
    t.$$.dirty & /*doc*/
    64 && o(l), t.$$.dirty & /*duplicateGroups*/
    128 && d(i), t.$$.dirty & /*duplicateGroups, selectedGroupIndex*/
    129 && k(i, m);
  }, [
    m,
    s,
    a,
    T,
    y,
    F,
    l,
    i,
    re
  ];
}
class Vt extends Y {
  constructor(e) {
    super(), W(this, e, Jt, qt, V, { doc: 6 });
  }
}
const xe = "@oscd-plugins/dedupe", Xt = "0.0.6";
function Ke(t) {
  var l;
  let e, n;
  return e = new Vt({
    props: { doc: (
      /*doc*/
      (l = t[0]) == null ? void 0 : l.documentElement
    ) }
  }), {
    c() {
      K(e.$$.fragment);
    },
    m(r, c) {
      z(e, r, c), n = !0;
    },
    p(r, c) {
      var o;
      const s = {};
      c & /*doc*/
      1 && (s.doc = /*doc*/
      (o = r[0]) == null ? void 0 : o.documentElement), e.$set(s);
    },
    i(r) {
      n || (v(e.$$.fragment, r), n = !0);
    },
    o(r) {
      I(e.$$.fragment, r), n = !1;
    },
    d(r) {
      J(e, r);
    }
  };
}
function Kt(t) {
  let e, n, l, r, c, s = (
    /*doc*/
    t[0] && Ke(t)
  );
  return {
    c() {
      s && s.c(), e = O(), n = p("input"), l = O(), r = p("input"), b(n, "type", "hidden"), b(n, "name", "package-name"), n.value = xe, b(r, "type", "hidden"), b(r, "name", "package-version"), r.value = Xt;
    },
    m(o, i) {
      s && s.m(o, i), w(o, e, i), w(o, n, i), w(o, l, i), w(o, r, i), c = !0;
    },
    p(o, [i]) {
      /*doc*/
      o[0] ? s ? (s.p(o, i), i & /*doc*/
      1 && v(s, 1)) : (s = Ke(o), s.c(), v(s, 1), s.m(e.parentNode, e)) : s && (pe(), I(s, 1, 1, () => {
        s = null;
      }), be());
    },
    i(o) {
      c || (v(s), c = !0);
    },
    o(o) {
      I(s), c = !1;
    },
    d(o) {
      s && s.d(o), o && S(e), o && S(n), o && S(l), o && S(r);
    }
  };
}
function Wt(t, e, n) {
  let { doc: l } = e;
  return t.$$set = (r) => {
    "doc" in r && n(0, l = r.doc);
  }, [l];
}
class Yt extends Y {
  constructor(e) {
    super(), W(this, e, Wt, Kt, V, { doc: 0 });
  }
}
class $t extends HTMLElement {
  constructor() {
    super(...arguments);
    ke(this, "plugin");
    ke(this, "_doc");
  }
  connectedCallback() {
    this.attachShadow({ mode: "open" }), this.plugin = new Yt({
      target: this.shadowRoot,
      props: {
        doc: this._doc
      }
    });
    const n = document.createElement("style");
    n.innerHTML = globalThis.pluginStyle[xe], this.shadowRoot.appendChild(n);
  }
  set doc(n) {
    this._doc = n, this.plugin && this.plugin.$set({ doc: n });
  }
}
export {
  $t as default
};
